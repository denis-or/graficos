library(tibble)
library(ggplot2)
library(dplyr)
library(magrittr)

df <- tibble::tibble(País = c("Alemanha","Alemanha",
                      "Alemanha","Alemanha","Alemanha","Alemanha","Alemanha",
                      "Alemanha","Alemanha","Alemanha","Alemanha","Alemanha",
                      "Alemanha","Alemanha","Alemanha","Alemanha","Alemanha",
                      "Alemanha","Alemanha","Austrália","Austrália",
                      "Austrália","Austrália","Austrália","Austrália",
                      "Austrália","Austrália","Austrália","Austrália","Austrália",
                      "Austrália","Austrália","Austrália","Austrália",
                      "Austrália","Austrália","Austrália","Austrália","Brasil",
                      "Brasil","Brasil","Brasil","Brasil","Brasil","Brasil",
                      "Brasil","Brasil","Brasil","Brasil","Brasil",
                      "Brasil","Brasil","Brasil","Brasil","Brasil","Brasil",
                      "Brasil","Canadá","Canadá","Canadá","Canadá","Canadá",
                      "Canadá","Canadá","Canadá","Canadá","Canadá",
                      "Canadá","Canadá","Canadá","Canadá","Canadá","Canadá",
                      "Canadá","Canadá","Canadá","China","China","China",
                      "China","China","China","China","China","China","China",
                      "China","China","China","China","China","China",
                      "China","China","China","Coreia do Sul",
                      "Coreia do Sul","Coreia do Sul","Coreia do Sul","Coreia do Sul",
                      "Coreia do Sul","Coreia do Sul","Coreia do Sul",
                      "Coreia do Sul","Coreia do Sul","Coreia do Sul","Coreia do Sul",
                      "Coreia do Sul","Coreia do Sul","Coreia do Sul",
                      "Coreia do Sul","Coreia do Sul","Coreia do Sul",
                      "Coreia do Sul","Espanha","Espanha","Espanha","Espanha",
                      "Espanha","Espanha","Espanha","Espanha","Espanha",
                      "Espanha","Espanha","Espanha","Espanha","Espanha","Espanha",
                      "Espanha","Espanha","Espanha","Espanha","EUA","EUA",
                      "EUA","EUA","EUA","EUA","EUA","EUA","EUA","EUA",
                      "EUA","EUA","EUA","EUA","EUA","EUA","EUA","EUA",
                      "EUA","França","França","França","França","França",
                      "França","França","França","França","França",
                      "França","França","França","França","França","França",
                      "França","França","França","Holanda","Holanda","Holanda",
                      "Holanda","Holanda","Holanda","Holanda","Holanda",
                      "Holanda","Holanda","Holanda","Holanda","Holanda",
                      "Holanda","Holanda","Holanda","Holanda","Holanda",
                      "Holanda","Indonésia","Indonésia","Indonésia","Indonésia",
                      "Indonésia","Indonésia","Indonésia","Indonésia",
                      "Indonésia","Indonésia","Indonésia","Indonésia",
                      "Indonésia","Indonésia","Indonésia","Indonésia","Indonésia",
                      "Indonésia","Indonésia","Irã","Irã","Irã","Irã",
                      "Irã","Irã","Irã","Irã","Irã","Irã","Irã","Irã",
                      "Irã","Irã","Irã","Irã","Irã","Irã","Irã","Itália",
                      "Itália","Itália","Itália","Itália","Itália","Itália",
                      "Itália","Itália","Itália","Itália","Itália",
                      "Itália","Itália","Itália","Itália","Itália","Itália",
                      "Itália","Japão","Japão","Japão","Japão","Japão",
                      "Japão","Japão","Japão","Japão","Japão","Japão","Japão",
                      "Japão","Japão","Japão","Japão","Japão","Japão",
                      "Japão","Polônia","Polônia","Polônia","Polônia",
                      "Polônia","Polônia","Polônia","Polônia","Polônia",
                      "Polônia","Polônia","Polônia","Polônia","Polônia","Polônia",
                      "Polônia","Polônia","Polônia","Polônia","Rússia",
                      "Rússia","Rússia","Rússia","Rússia","Rússia","Rússia",
                      "Rússia","Rússia","Rússia","Rússia","Rússia",
                      "Rússia","Rússia","Rússia","Rússia","Rússia","Rússia",
                      "Rússia","Taiwan","Taiwan","Taiwan","Taiwan","Taiwan",
                      "Taiwan","Taiwan","Taiwan","Taiwan","Taiwan",
                      "Taiwan","Taiwan","Taiwan","Taiwan","Taiwan","Taiwan",
                      "Taiwan","Taiwan","Taiwan","Turquia","Turquia","Turquia",
                      "Turquia","Turquia","Turquia","Turquia","Turquia",
                      "Turquia","Turquia","Turquia","Turquia","Turquia",
                      "Turquia","Turquia","Turquia","Turquia","Turquia",
                      "Turquia","UK","UK","UK","UK","UK","UK","UK","UK",
                      "UK","UK","UK","UK","UK","UK","UK","UK","UK","UK",
                      "UK","Índia","Índia","Índia","Índia","Índia",
                      "Índia","Índia","Índia","Índia","Índia","Índia","Índia",
                      "Índia","Índia","Índia","Índia","Índia","Índia",
                      "Índia"),
             Ano = c(2014L,2015L,2000L,2001L,
                     2008L,2009L,2010L,2011L,2012L,2013L,2016L,2017L,
                     2018L,2002L,2003L,2004L,2005L,2006L,2007L,2000L,2001L,
                     2002L,2003L,2006L,2007L,2008L,2009L,2010L,2011L,
                     2014L,2004L,2005L,2012L,2013L,2015L,2016L,2017L,
                     2018L,2018L,2012L,2013L,2015L,2017L,2007L,2008L,
                     2009L,2010L,2011L,2014L,2016L,2006L,2002L,2003L,
                     2004L,2005L,2000L,2001L,2000L,2002L,2003L,2004L,
                     2005L,2006L,2007L,2008L,2009L,2001L,2010L,2011L,
                     2012L,2013L,2014L,2015L,2016L,2017L,2018L,2016L,2017L,
                     2018L,2004L,2005L,2006L,2007L,2008L,2009L,2010L,
                     2011L,2012L,2013L,2014L,2015L,2003L,2002L,2000L,
                     2001L,2015L,2016L,2018L,2010L,2011L,2012L,2013L,
                     2014L,2017L,2006L,2007L,2008L,2009L,2004L,2005L,
                     2002L,2003L,2000L,2001L,2005L,2006L,2000L,2001L,
                     2002L,2003L,2004L,2007L,2008L,2009L,2010L,2011L,
                     2012L,2013L,2014L,2015L,2016L,2017L,2018L,2000L,2001L,
                     2002L,2003L,2004L,2005L,2006L,2007L,2008L,2009L,
                     2010L,2011L,2012L,2013L,2014L,2015L,2016L,2017L,
                     2018L,2000L,2001L,2002L,2003L,2004L,2005L,2006L,
                     2007L,2008L,2009L,2010L,2011L,2012L,2013L,2014L,
                     2015L,2016L,2017L,2018L,2000L,2001L,2002L,2003L,
                     2004L,2005L,2006L,2007L,2008L,2009L,2010L,2011L,
                     2012L,2013L,2014L,2015L,2016L,2017L,2018L,2018L,2000L,
                     2001L,2002L,2003L,2004L,2005L,2006L,2007L,2008L,
                     2009L,2010L,2011L,2012L,2013L,2014L,2015L,2016L,
                     2017L,2014L,2015L,2016L,2017L,2018L,2011L,2012L,
                     2013L,2010L,2009L,2008L,2000L,2001L,2002L,2003L,
                     2004L,2005L,2006L,2007L,2000L,2001L,2002L,2003L,
                     2004L,2005L,2006L,2007L,2008L,2009L,2017L,2010L,
                     2011L,2012L,2013L,2014L,2015L,2016L,2018L,2000L,2001L,
                     2002L,2003L,2004L,2005L,2006L,2007L,2008L,2009L,
                     2010L,2011L,2012L,2013L,2014L,2015L,2016L,2017L,
                     2018L,2000L,2001L,2002L,2003L,2017L,2018L,2004L,
                     2005L,2006L,2007L,2008L,2015L,2016L,2009L,2014L,
                     2010L,2011L,2012L,2013L,2018L,2001L,2017L,2000L,
                     2002L,2003L,2004L,2016L,2005L,2006L,2007L,2008L,
                     2009L,2010L,2011L,2012L,2013L,2014L,2015L,2005L,2006L,
                     2007L,2008L,2009L,2010L,2011L,2012L,2013L,2004L,
                     2014L,2002L,2003L,2000L,2001L,2015L,2016L,2017L,
                     2018L,2015L,2016L,2009L,2010L,2017L,2018L,2004L,
                     2005L,2006L,2007L,2008L,2011L,2012L,2013L,2003L,
                     2014L,2002L,2000L,2001L,2000L,2001L,2002L,2003L,
                     2004L,2005L,2006L,2007L,2008L,2009L,2010L,2011L,
                     2012L,2013L,2014L,2015L,2016L,2017L,2018L,2016L,2017L,
                     2018L,2015L,2011L,2012L,2013L,2014L,2010L,2007L,
                     2008L,2009L,2005L,2006L,2002L,2003L,2004L,2000L,
                     2001L),
             Posição = c("3º","3º","4º","4º","4º",
                         "4º","4º","4º","4º","4º","4º","4º","4º","5º","5º",
                         "5º","5º","5º","5º","11º","11º","12º","12º",
                         "12º","12º","12º","12º","12º","12º","12º","13º",
                         "13º","13º","13º","13º","14º","14º","14º","11º","12º",
                         "12º","12º","12º","13º","13º","13º","13º","13º",
                         "13º","13º","14º","15º","15º","15º","16º","17º",
                         "17º","8º","8º","8º","8º","8º","8º","8º","8º",
                         "8º","9º","9º","9º","9º","9º","9º","10º","11º",
                         "11º","12º","1º","1º","1º","2º","2º","2º","2º","2º",
                         "2º","2º","2º","2º","2º","2º","2º","3º","4º",
                         "5º","5º","9º","9º","9º","10º","10º","10º","10º",
                         "10º","10º","11º","11º","11º","11º","12º","12º",
                         "13º","13º","14º","14º","9º","9º","10º","10º",
                         "10º","10º","10º","10º","10º","10º","11º","11º","11º",
                         "11º","11º","11º","12º","13º","13º","1º","1º",
                         "1º","1º","1º","1º","1º","1º","1º","1º","1º","1º",
                         "1º","1º","1º","1º","2º","2º","2º","6º","6º",
                         "6º","6º","6º","6º","6º","6º","6º","6º","6º","7º",
                         "7º","7º","7º","7º","7º","9º","10º","13º","13º",
                         "14º","14º","14º","14º","16º","16º","16º","16º",
                         "16º","17º","17º","17º","17º","18º","18º","18º",
                         "18º","19º",NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
                         NA,NA,NA,NA,NA,NA,"21º","15º","15º","15º",
                         "15º","15º","16º","16º","16º","18º","19º","20º",NA,
                         NA,NA,NA,NA,NA,NA,NA,"7º","7º","7º","7º","7º",
                         "7º","7º","7º","7º","7º","7º","8º","8º","8º",
                         "8º","8º","8º","8º","8º","2º","2º","2º","2º","3º",
                         "3º","3º","3º","3º","3º","3º","3º","3º","3º",
                         "4º","5º","5º","5º","5º","16º","16º","16º","16º",
                         "16º","16º","17º","17º","17º","17º","17º","17º",
                         "17º","18º","18º","19º","19º","19º","19º","7º","8º",
                         "8º","9º","9º","9º","9º","10º","11º","13º","14º",
                         "14º","14º","14º","14º","14º","14º","14º","14º",
                         "15º","15º","15º","15º","15º","15º","15º","15º",
                         "15º","16º","16º","17º","17º","18º","18º","19º",
                         "19º","19º","20º","16º","16º","17º","17º","17º",
                         "17º","18º","18º","18º","18º","18º","18º","18º",
                         "18º","19º","19º","20º",NA,NA,"3º","3º","3º","4º",
                         "4º","4º","4º","4º","5º","5º","5º","5º","5º",
                         "5º","5º","6º","6º","6º","6º","3º","3º","3º","4º",
                         "6º","6º","6º","6º","7º","9º","9º","9º","10º",
                         "10º","11º","11º","11º","12º","12º")
)



cores <- c("#C16B44","#1B6097","#E3B754","#96C66F","#CC3075","#852A6D",
           "#C71E59","#218055","#E58997","#236886","#41A34F","#EEC1B3",
           "#770F1A","#125577","#AC7DA9","#E08E9F","#D4D056","#E59646",
           "#85C09D","#5F5881")

rotulo <- c("China","EUA","Índia","Alemanha","Japão","UK","Rússia","Itália",
            "Coreia do Sul", "França","Brasil","Canadá","Espanha","Austrália",
            "Irã","Polônia","Turquia","Holanda","Indonésia","Taiwan")

posicao <- c("1º","2º","3º","4º","5º","6º","7º","8º","9º","10º",
             "11º","12º","13º","14º","15º","16º","17º","18º","19º","20º")

df <- df |>
  dplyr::mutate(Posição = factor(Posição, levels = posicao),
                País = factor(País, levels = rotulo)) |>
  dplyr::filter(!is.na(Posição))



ggplot2::ggplot(data = df, ggplot2::aes(
  x = Ano,
  y = forcats::fct_rev(Posição),
  group = País,
  colour = País
)) +
  ggplot2::geom_line(size = 1.5, show.legend = F) +
  ggplot2::geom_text(
    data = dplyr::filter(df, Ano == 2018),
    ggplot2::aes(label = País, color = País),
    hjust = 0,
    nudge_x = 0.05,
    fontface = "bold",
    size = 5,
    show.legend = F
  ) +
  ggplot2::scale_x_continuous(breaks = seq(2000, 2018, 1), expand = c(0, 0)) +
  ggplot2::scale_colour_manual(values = cores) +
  ggplot2::labs(
    x = "",
    y = "",
    title = " 1. POSIÇÃO (NÚMERO DE PUBLICAÇÕES - CONTAGEM FRACIONÁRIA) ",
    caption = "Visualização: Denis de Oliveira Rodrigues\nGithub: denis-or"
  ) + expand_limits(x = 2020) +
  ggplot2::theme_minimal() +
  ggplot2::theme(
    plot.title = element_text(
      size = 18,
      face = "bold",
      color = "#22568B",
      family = "Arial Narrow"
    ),
    plot.title.position = "plot",
    panel.grid.minor.x = ggplot2::element_blank(),
    panel.grid.minor.y = ggplot2::element_blank(),
    panel.grid.major.x = ggplot2::element_line(),
    axis.text = ggplot2::element_text(size = 12, face = "bold")
  )


